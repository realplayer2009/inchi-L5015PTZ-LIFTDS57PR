# éƒ¨ç½²æ€»ç»“ - InchiPTZ æœåŠ¡

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ä»£ç æ›´æ–°
- âœ… å°†é€šä¿¡æ–¹å¼ä»ä¸²å£æ”¹ä¸º TCPï¼ˆ192.168.25.78:502ï¼‰
- âœ… API ç›‘å¬åœ°å€æ”¹ä¸º 0.0.0.0ï¼ˆæ”¯æŒè¿œç¨‹è®¿é—®ï¼‰
- âœ… æ›´æ–°æ‰€æœ‰é…ç½®æ–‡ä»¶å’Œæ–‡æ¡£

### 2. æ‰“åŒ…é…ç½®
- âœ… æ›´æ–° `debian/control` - åŒ…ä¿¡æ¯å’Œä¾èµ–
- âœ… æ›´æ–° `debian/inchiptz.service` - systemd æœåŠ¡é…ç½®
- âœ… æ›´æ–° `debian/postinst` - å®‰è£…åè‡ªåŠ¨é…ç½®
- âœ… æ›´æ–° `build_deb.sh` - ç‰ˆæœ¬å·å‡çº§åˆ° 1.0.1

### 3. éƒ¨ç½²è„šæœ¬
- âœ… `build_deb.sh` - æ„å»º deb åŒ…
- âœ… `deploy.sh` - å®Œæ•´éƒ¨ç½²æµç¨‹
- âœ… `quick_deploy.sh` - ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

### 4. æ–‡æ¡£
- âœ… `DEPLOY_DEBIAN.md` - è¯¦ç»†éƒ¨ç½²æŒ‡å—ï¼ˆDebian/Ubuntu 18.04+ï¼‰
- âœ… `PACKAGE_DEPLOY.md` - æ‰“åŒ…å’Œéƒ¨ç½²è¯´æ˜
- âœ… åŒ…å«å®Œæ•´çš„æ•…éšœæ’æŸ¥æŒ‡å—

## ğŸ“‹ ç³»ç»Ÿé…ç½®

### éƒ¨ç½²ç›®æ ‡
- **ç›®æ ‡æœåŠ¡å™¨**: 192.168.25.88
- **ç›®æ ‡ç³»ç»Ÿ**: Debian/Ubuntu 18.04+
- **ç”¨æˆ·**: root

### æœåŠ¡é…ç½®
- **PTZ è®¾å¤‡åœ°å€**: 192.168.25.78:502 (TCP Modbus)
- **API ç›‘å¬åœ°å€**: 0.0.0.0:50278
- **YAW ç”µæœº ID**: 1
- **PITCH ç”µæœº ID**: 2
- **è½®è¯¢é—´éš”**: 500ms

### è§’åº¦é™åˆ¶
- **YAW (æ—‹è½¬)**: -85Â° ~ +85Â°
- **PITCH (ä¿¯ä»°)**: -10Â° ~ +85Â°

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹å¼ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

éœ€è¦åœ¨ Linux/WSL/Git Bash ç¯å¢ƒä¸‹è¿è¡Œï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /r/githubw/inchiPTZ

# 2. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x quick_deploy.sh build_deb.sh deploy.sh

# 3. ä¸€é”®éƒ¨ç½²
./quick_deploy.sh
```

### æ–¹å¼äºŒï¼šåˆ†æ­¥æ‰§è¡Œ

```bash
# 1. æ„å»º deb åŒ…
bash build_deb.sh

# è¾“å‡º: inchiptz_1.0.1_all.deb

# 2. éƒ¨ç½²åˆ°æœåŠ¡å™¨
bash deploy.sh
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨éƒ¨ç½²

è¯¦è§ `DEPLOY_DEBIAN.md` æ–‡æ¡£ã€‚

## ğŸ“¦ æ‰“åŒ…å†…å®¹

ç”Ÿæˆæ–‡ä»¶ï¼š`inchiptz_1.0.1_all.deb`

åŒ…å«å†…å®¹ï¼š
```
/usr/share/inchiptz/
â”œâ”€â”€ api_server.py          # Flask API æœåŠ¡å™¨ï¼ˆå·²æ›´æ–° TCP é»˜è®¤é…ç½®ï¼‰
â”œâ”€â”€ ptz_controller.py      # PTZ æ§åˆ¶å™¨
â”œâ”€â”€ rs485_comm.py          # é€šä¿¡å±‚ï¼ˆæ”¯æŒ TCP/ä¸²å£ï¼‰
â”œâ”€â”€ lift_motor.py          # ç”µæœºæ§åˆ¶
â””â”€â”€ proto_v43.py           # åè®®å®šä¹‰

/etc/systemd/system/
â””â”€â”€ inchiptz.service       # systemd æœåŠ¡ï¼ˆå·²é…ç½® TCPï¼‰

/var/log/inchiptz/
â”œâ”€â”€ operation.log          # æ“ä½œæ—¥å¿—
â””â”€â”€ error.log              # é”™è¯¯æ—¥å¿—
```

## ğŸ§ª æµ‹è¯•ç»“æœ

å·²åœ¨æœ¬åœ°æµ‹è¯•é€šè¿‡ï¼š
- âœ… TCP è¿æ¥æ­£å¸¸ï¼ˆ192.168.25.78:502ï¼‰
- âœ… API å¥åº·æ£€æŸ¥æ­£å¸¸
- âœ… è§’åº¦è®¾ç½®æˆåŠŸï¼ˆyaw=60Â°, pitch=60Â°ï¼‰
- âœ… çŠ¶æ€è¯»å–æ­£å¸¸
- âœ… æ¸©åº¦è¯»å–æ­£å¸¸

## ğŸ“ API ä½¿ç”¨ç¤ºä¾‹

### ä» Windows PowerShell æµ‹è¯•

```powershell
# å¥åº·æ£€æŸ¥
Invoke-RestMethod -Uri "http://192.168.25.88:50278/health"

# è·å–çŠ¶æ€
Invoke-RestMethod -Uri "http://192.168.25.88:50278/get_status"

# è®¾ç½®ä½ç½®
$body = @{yaw=60.0; pitch=60.0} | ConvertTo-Json
Invoke-RestMethod -Uri "http://192.168.25.88:50278/set_position" `
  -Method Post -Body $body -ContentType "application/json"
```

### ä» Linux/Mac æµ‹è¯•

```bash
# å¥åº·æ£€æŸ¥
curl http://192.168.25.88:50278/health

# è·å–çŠ¶æ€
curl http://192.168.25.88:50278/get_status

# è®¾ç½®ä½ç½®
curl -X POST http://192.168.25.88:50278/set_position \
  -H 'Content-Type: application/json' \
  -d '{"yaw": 60.0, "pitch": 60.0}'
```

## ğŸ”§ éƒ¨ç½²åç®¡ç†

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
ssh root@192.168.25.88 'systemctl status inchiptz'
```

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
ssh root@192.168.25.88 'journalctl -u inchiptz -f'
```

### é‡å¯æœåŠ¡
```bash
ssh root@192.168.25.88 'systemctl restart inchiptz'
```

### åœæ­¢æœåŠ¡
```bash
ssh root@192.168.25.88 'systemctl stop inchiptz'
```

### å¯åŠ¨æœåŠ¡
```bash
ssh root@192.168.25.88 'systemctl start inchiptz'
```

## ğŸ“– è¯¦ç»†æ–‡æ¡£

1. **PACKAGE_DEPLOY.md** - æ‰“åŒ…å’Œéƒ¨ç½²æ€»ä½“è¯´æ˜
2. **DEPLOY_DEBIAN.md** - Debian/Ubuntu 18.04+ è¯¦ç»†éƒ¨ç½²æŒ‡å—
   - ç³»ç»Ÿè¦æ±‚
   - å®‰è£…æ­¥éª¤
   - é…ç½®è¯´æ˜
   - æ•…éšœæ’æŸ¥
   - æ€§èƒ½ä¼˜åŒ–
   - å®‰å…¨å»ºè®®

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œè¦æ±‚**
   - éƒ¨ç½²æœºå™¨éœ€è¦èƒ½ SSH åˆ° 192.168.25.88
   - 192.168.25.88 éœ€è¦èƒ½è®¿é—® 192.168.25.78:502
   - å®¢æˆ·ç«¯éœ€è¦èƒ½è®¿é—® 192.168.25.88:50278

2. **ç³»ç»Ÿè¦æ±‚**
   - Debian 9+ æˆ– Ubuntu 18.04+
   - Python 3.6+
   - éœ€è¦ root æƒé™

3. **é˜²ç«å¢™è®¾ç½®**
   - ç¡®ä¿ç«¯å£ 50278 å¼€æ”¾ï¼ˆå¦‚éœ€è¿œç¨‹è®¿é—®ï¼‰
   - å¦‚æœæœ‰é˜²ç«å¢™ï¼Œè¿è¡Œï¼š`sudo ufw allow 50278/tcp`

4. **Python ä¾èµ–**
   - å®‰è£…åŒ…ä¼šè‡ªåŠ¨å®‰è£…ä¾èµ–
   - å¦‚æœè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œæ‰‹åŠ¨è¿è¡Œï¼š
     ```bash
     sudo pip3 install pymodbus pyserial flask
     ```

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åœ¨ Windows ä¸Šè¿è¡Œ shell è„šæœ¬ï¼Ÿ
A: ä½¿ç”¨ä»¥ä¸‹ä»»ä¸€æ–¹å¼ï¼š
- Git Bashï¼ˆæ¨èï¼‰
- WSL (Windows Subsystem for Linux)
- Cygwin

### Q2: æœåŠ¡æ— æ³•å¯åŠ¨æ€ä¹ˆåŠï¼Ÿ
A: æŸ¥çœ‹æ—¥å¿—æ’æŸ¥ï¼š
```bash
ssh root@192.168.25.88 'journalctl -u inchiptz -n 50 --no-pager'
```

### Q3: API æ— æ³•è®¿é—®æ€ä¹ˆåŠï¼Ÿ
A: æ£€æŸ¥ï¼š
1. æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`systemctl status inchiptz`
2. ç«¯å£æ˜¯å¦ç›‘å¬ï¼š`netstat -tunlp | grep 50278`
3. é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ï¼š`ufw status`

### Q4: æ— æ³•è¿æ¥ PTZ è®¾å¤‡ï¼Ÿ
A: æµ‹è¯•ç½‘ç»œï¼š
```bash
ping 192.168.25.78
telnet 192.168.25.78 502
```

### Q5: å¦‚ä½•ä¿®æ”¹é…ç½®ï¼Ÿ
A: ç¼–è¾‘æœåŠ¡æ–‡ä»¶ï¼š
```bash
sudo nano /etc/systemd/system/inchiptz.service
sudo systemctl daemon-reload
sudo systemctl restart inchiptz
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. ç³»ç»Ÿä¿¡æ¯ï¼š`cat /etc/os-release`
2. Python ç‰ˆæœ¬ï¼š`python3 --version`
3. æœåŠ¡æ—¥å¿—ï¼š`journalctl -u inchiptz -n 100 --no-pager`
4. é”™è¯¯æ—¥å¿—ï¼š`cat /var/log/inchiptz/error.log`

## ğŸ¯ ä¸‹ä¸€æ­¥

éƒ¨ç½²å®Œæˆåï¼š
1. âœ… æµ‹è¯• API æ¥å£
2. âœ… éªŒè¯ PTZ è®¾å¤‡æ§åˆ¶
3. âœ… æŸ¥çœ‹æ—¥å¿—ç¡®è®¤è¿è¡Œæ­£å¸¸
4. âœ… é…ç½®å¼€æœºè‡ªå¯åŠ¨ï¼ˆå·²è‡ªåŠ¨é…ç½®ï¼‰
5. âœ… æ ¹æ®éœ€è¦è°ƒæ•´å‚æ•°
6. âœ… é…ç½®é˜²ç«å¢™ï¼ˆå¦‚éœ€ï¼‰

---

**å‡†å¤‡å°±ç»ªï¼è¿è¡Œ `./quick_deploy.sh` å¼€å§‹éƒ¨ç½²ï¼**
